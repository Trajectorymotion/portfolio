param (
    [string]$Path,
    [string]$Search
)

$content = Get-Content -Path $Path -Raw
$idx = $content.IndexOf($Search)
if ($idx -ge 0) {
    $start = [Math]::Max(0, $idx - 500)
    $len = [Math]::Min(1000, $content.Length - $start)
    $content.Substring($start, $len) | Out-File -FilePath snippet.txt -Encoding utf8
    Write-Output "Snippet saved to snippet.txt"
} else {
    Write-Output "Search string not found"
}
